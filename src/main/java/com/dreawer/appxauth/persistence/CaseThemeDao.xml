<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dreawer.appxauth.domain.AppCaseTheme">

    <!-- ================================================================================== -->
    <!-- SQL查询																				-->
    <!-- ================================================================================== -->

    <select id="findThemesByCondition" parameterType="AppCaseTheme" resultMap="AppCaseThemeResultMap">
        SELECT
        <include refid="basicFields"/>
        FROM appx_case_thm
        <where>
            <if test="name !=null">
                name =#{name}
            </if>
            <if test="caseId !=null">
                AND case_id=#{caseId}
            </if>
            <if test="sortOrder !=null">
                AND sort_order=#{sortOrder}
            </if>
            <if test="status !=null">
                AND status=#{status}
            </if>
        </where>
    </select>

    <select id="findThemesByCaseId" parameterType="String" resultMap="AppCaseThemeResultMap">
        SELECT
        <include refid="basicFields"/>
        FROM appx_case_thm
        WHERE case_id = #{caseId}
    </select>

    <select id="findThemeById" parameterType="String" resultMap="AppCaseThemeResultMap">
        SELECT
        <include refid="basicFields"/>
        FROM appx_case_thm
        WHERE id = #{themeId}
    </select>

    <select id="findThemeBySpuId" parameterType="String" resultMap="AppCaseThemeResultMap">
        SELECT
        <include refid="basicFields"/>
        FROM appx_case_thm
        WHERE spuId =#{merchandiseId}
    </select>

    <select id="findAllThemes" resultMap="AppCaseThemeResultMap">
        SELECT
        <include refid="basicFields"/>
        FROM appx_case_thm
        ORDER BY cre_tim ASC
    </select>

    <!-- ================================================================================== -->
    <!-- SQL更新																	-->
    <!-- ================================================================================== -->
    <update id="updateTempIdByThemId" parameterType="AppCaseTheme">
        UPDATE appx_case_thm
        SET temp_id = #{templateId}
        WHERE id = #{id}
    </update>

    <!-- ================================================================================== -->
    <!-- 公用SQL定义																			-->
    <!-- ================================================================================== -->

    <!-- 基本信息 -->
    <sql id="basicFields">
        id, name, case_id, sort_order, temp_id, spuId, status, crer_id, cre_tim, updr_id, upd_tim
    </sql>

    <!-- ================================================================================== -->
    <!-- 结果集映射																				-->
    <!-- ================================================================================== -->
    <resultMap id="AppCaseThemeResultMap" type="AppCaseTheme">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="caseId" column="case_id"/>
        <result property="sortOrder" column="sort_order"/>
        <result property="templateId" column="temp_id"/>
        <result property="spuId" column="spuId"/>
        <result property="status" column="status"/>
        <result property="creater.id" column="crer_id"/>
        <result property="createTime" column="cre_tim"/>
        <result property="updater.id" column="updr_id"/>
        <result property="updateTime" column="upd_tim"/>
    </resultMap>

</mapper>